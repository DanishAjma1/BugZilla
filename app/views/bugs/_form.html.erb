<%= form_with model: [project,project.bugs.build] do |form| %>
  <div>
    <%= form.label :title, "Title" %>
    <%= form.text_field :title %>
  </div>

  <div>
    <%= form.label :bug_type, "bug_type" %><br>
    <%= form.radio_button :bug_type, "feature", checked: @bug.bug_type == "feature" %>
    <%= form.label :bug_type_feature, "Feature" %><br>

    <%= form.radio_button :bug_type, "bug", checked: @bug.bug_type == "bug" %>
    <%= form.label :bug_type_bug, "Bug" %>
  </div>

  <div>
    <%= form.label :status, "Status" %>
    <%= form.select :status, status_options(@bug.bug_type) %>
  </div>

  <div>
    <%= form.label :description, "Description" %>
    <%= form.text_area :description %>
  </div>

  <div>
    <%= form.label :deadline, "Deadline" %>
    <%= form.date_field :deadline %>
  </div>

  <div>
    <%= form.submit "Save Bug" %>
  </div>
<% end %>

<script>
  // JavaScript to update status dropdown based on bug_bug_type selection
  document.querySelectorAll('input[name="bug[bug_type]"]').forEach(function (radio) {
    radio.addEventListener('change', function () {
      var selectedbug_type = this.value;
      var statusSelect = document.querySelector('select[name="bug[status]"]');
      statusSelect.innerHTML = ''; // Clear existing options

      var options = [];
      if (selectedbug_type === "feature") {
        options = ["new", "started", "complete"];
      } else if (selectedbug_type === "bug") {
        options = ["new", "started", "resolved"];
      }

      options.forEach(function (status) {
        var option = document.createElement('option');
        option.value = status;
        option.textContent = status.charAt(0).toUpperCase() + status.slice(1);
        statusSelect.appendChild(option);
      });
    });
  });
</script>
